{"componentChunkName":"component---src-templates-doc-js","path":"/docs/v2.4/deployment/traefik/","result":{"pageContext":{"html":"<h1 id=\"implement-traefik-into-api-platform-dockerized\" style=\"position:relative;\"><a href=\"#implement-traefik-into-api-platform-dockerized\" aria-label=\"implement traefik into api platform dockerized permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Implement Traefik Into API Platform Dockerized</h1>\n<blockquote>\n<p>An open-source reverse proxy and load balancer for HTTP and TCP-based applications that is easy, dynamic, automatic, fast, full-featured, production proven, provides metrics, and integrates with every major cluster technology.</p>\n<p>â€”<a href=\"https://traefik.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://traefik.io</a></p>\n</blockquote>\n<h2 id=\"basic-implementation\" style=\"position:relative;\"><a href=\"#basic-implementation\" aria-label=\"basic implementation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Basic Implementation</h2>\n<p>This tutorial will help you to define your own routes for your client, api and more generally for your containers.</p>\n<p>Use this custom API Platform <code class=\"language-text\">docker-compose.yml</code> file which implements ready-to-use Traefik container configuration. Override\nports and add labels to tell Traefik to listen on the routes mentioned and redirect routes to specified container.</p>\n<p>A few points to note:</p>\n<ul>\n<li><code class=\"language-text\">--api</code> Tells Traefik to generate a browser view to watch containers and IP/DNS associated easier  </li>\n<li><code class=\"language-text\">--docker</code> Tells Traefik to listen on Docker Api  </li>\n<li>\n<p><code class=\"language-text\">labels:</code> Key for Traefik configuration into Docker integration</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">#  ...</span>\n<span class=\"token key atrule\">api</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span> \n    <span class=\"token punctuation\">-</span> traefik.frontend.rule=Host<span class=\"token punctuation\">:</span>api.localhost</code></pre></div>\n<p>The API DNS will be specified with <code class=\"language-text\">traefik.frontend.rule=Host:your.host</code> (here api.localhost)</p>\n</li>\n<li><code class=\"language-text\">--traefik.port=3000</code> The port specified to Traefik will be exposed by the container (here the React app exposes the 3000 port)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># docker-compose.yml</span>\n<span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3.4'</span>\n\n<span class=\"token key atrule\">x-cache</span><span class=\"token punctuation\">:</span>\n  <span class=\"token important\">&amp;cache</span>\n  <span class=\"token key atrule\">cache_from</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/php\n    <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/nginx\n    <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/varnish\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">traefik</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> traefik\n    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>api <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>docker\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"80:80\"</span> <span class=\"token comment\">#All HTTP access will be caught by Traefik</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"443:443\"</span> <span class=\"token comment\">#All HTTPS access will be caught by Traefik</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"8080:8080\"</span> <span class=\"token comment\">#Access Traefik webview</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock\n\n  <span class=\"token key atrule\">php</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/php\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./api\n      <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> api_platform_php\n      <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*cache</span>\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> db\n    <span class=\"token comment\"># Comment out these volumes in production</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./api<span class=\"token punctuation\">:</span>/srv/api<span class=\"token punctuation\">:</span>rw<span class=\"token punctuation\">,</span>cached\n      <span class=\"token comment\"># If you develop on Linux, uncomment the following line to use a bind-mounted host directory instead</span>\n      <span class=\"token comment\"># - ./api/var:/srv/api/var:rw</span>\n\n  <span class=\"token key atrule\">api</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/nginx\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.frontend.rule=Host<span class=\"token punctuation\">:</span>api.localhost\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./api\n      <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> api_platform_nginx\n      <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*cache</span>\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> php\n    <span class=\"token comment\"># Comment out this volume in production</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./api/public<span class=\"token punctuation\">:</span>/srv/api/public<span class=\"token punctuation\">:</span>ro\n\n  <span class=\"token key atrule\">cache-proxy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/varnish\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./api\n      <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> api_platform_varnish\n      <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*cache</span>\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> api\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./api/docker/varnish/conf<span class=\"token punctuation\">:</span>/usr/local/etc/varnish<span class=\"token punctuation\">:</span>ro\n    <span class=\"token key atrule\">tmpfs</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> /usr/local/var/varnish<span class=\"token punctuation\">:</span>exec\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.frontend.rule=Host<span class=\"token punctuation\">:</span>cache.localhost\n\n  <span class=\"token key atrule\">db</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># In production, you may want to use a managed database service</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> postgres<span class=\"token punctuation\">:</span>10<span class=\"token punctuation\">-</span>alpine\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.frontend.rule=Host<span class=\"token punctuation\">:</span>db.localhost\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> POSTGRES_DB=api\n      <span class=\"token punctuation\">-</span> POSTGRES_USER=api<span class=\"token punctuation\">-</span>platform\n      <span class=\"token comment\"># You should definitely change the password in production</span>\n      <span class=\"token punctuation\">-</span> POSTGRES_PASSWORD=<span class=\"token tag\">!ChangeMe</span><span class=\"token tag\">!</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> db<span class=\"token punctuation\">-</span>data<span class=\"token punctuation\">:</span>/var/lib/postgresql/data<span class=\"token punctuation\">:</span>rw\n      <span class=\"token comment\"># You may use a bind-mounted host directory instead, so that it is harder to accidentally remove the volume and lose all your data!</span>\n      <span class=\"token comment\"># - ./docker/db/data:/var/lib/postgresql/data:rw</span>\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"5432:5432\"</span>\n\n  <span class=\"token key atrule\">mercure</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># In production, you may want to use the managed version of Mercure, https://mercure.rocks</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> dunglas/mercure\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># You should definitely change all these values in production</span>\n      <span class=\"token punctuation\">-</span> JWT_KEY=<span class=\"token tag\">!UnsecureChangeMe</span><span class=\"token tag\">!</span>\n      <span class=\"token punctuation\">-</span> ALLOW_ANONYMOUS=1\n      <span class=\"token punctuation\">-</span> CORS_ALLOWED_ORIGINS=*\n      <span class=\"token punctuation\">-</span> PUBLISH_ALLOWED_ORIGINS=http<span class=\"token punctuation\">:</span>//mercure.localhost\n      <span class=\"token punctuation\">-</span> DEMO=1\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.frontend.rule=Host<span class=\"token punctuation\">:</span>localhost\n\n  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Use a static website hosting service in production</span>\n    <span class=\"token comment\"># See https://github.com/facebookincubator/create-react-app/blob/master/packages/react-scripts/template/README.mddeployment</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/client\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./client\n      <span class=\"token key atrule\">cache_from</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/client\n    <span class=\"token key atrule\">env_file</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./client/.env\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./client<span class=\"token punctuation\">:</span>/usr/src/client<span class=\"token punctuation\">:</span>rw<span class=\"token punctuation\">,</span>cached\n      <span class=\"token punctuation\">-</span> /usr/src/client/node_modules\n    <span class=\"token key atrule\">expose</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token number\">3000</span>\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.port=3000\n      <span class=\"token punctuation\">-</span> traefik.frontend.rule=Host<span class=\"token punctuation\">:</span>localhost\n\n  <span class=\"token key atrule\">admin</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Use a static website hosting service in production</span>\n    <span class=\"token comment\"># See https://facebook.github.io/create-react-app/docs/deployment</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/admin\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./admin\n      <span class=\"token key atrule\">cache_from</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/admin\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./admin<span class=\"token punctuation\">:</span>/usr/src/admin<span class=\"token punctuation\">:</span>rw<span class=\"token punctuation\">,</span>cached\n      <span class=\"token punctuation\">-</span> /usr/src/admin/node_modules\n    <span class=\"token key atrule\">expose</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token number\">3000</span>\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.port=3000\n      <span class=\"token punctuation\">-</span> traefik.frontend.rule=Host<span class=\"token punctuation\">:</span>admin.localhost\n\n<span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">db-data</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>Don't forget the db-data, or the database won't work in this dockerized solution.</p>\n<p><code class=\"language-text\">localhost</code> is a reserved domain referred to in your <code class=\"language-text\">/etc/hosts</code>.\nIf you want to implement custom DNS such as production DNS in local, just add them at the end of your <code class=\"language-text\">/etc/host</code> file like that: </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># /etc/hosts\n# ...\n\n127.0.0.1       your.domain.com</code></pre></div>\n<p>If you do that, you'll have to update the <code class=\"language-text\">CORS_ALLOW_ORIGIN</code> environment variable <code class=\"language-text\">api/.env</code> to accept the specified URL.</p>\n<h2 id=\"known-issues\" style=\"position:relative;\"><a href=\"#known-issues\" aria-label=\"known issues permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Known Issues</h2>\n<p>If your network is of type B, it may conflict with the Traefik sub-network.</p>\n<h2 id=\"going-further\" style=\"position:relative;\"><a href=\"#going-further\" aria-label=\"going further permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Going Further</h2>\n<p>As this Traefik configuration listens on 80 and 443 ports, you can run only 1 Traefik instance per server. However, you may want to run multiple API Platform projects on same server. To deal with it, you'll have to externalize the Traefik configuration to another <code class=\"language-text\">docker-compose.yml</code> file, anywhere on your server.</p>\n<p>Here is a working example:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># /somewhere/docker-compose.yml</span>\n<span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3.4'</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">traefik</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> traefik\n    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>api <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>docker\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"80:80\"</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"443:443\"</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"8080:8080\"</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock\n<span class=\"token comment\"># load a TOML configuration file and to generate Let's Encrypt certificated as explained in https://docs.traefik.io/user-guide/docker-and-lets-encrypt/</span>\n<span class=\"token comment\">#      - ./traefik.toml:/traefik.toml</span>\n<span class=\"token comment\">#      - ./acme.json:/acme.json</span>\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> api_platform_network\n    <span class=\"token comment\"># Add other networks here</span>\n\n<span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">api_platform_network</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">external</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token comment\"># Add other networks here</span></code></pre></div>\n<p>Then update the <code class=\"language-text\">docker-compose.yml</code> file belonging to your API Platform projects:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"># docker-compose.yml\nversion: '3.4'\n\nx-cache:\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> &amp;cache\n<span class=\"token prefix unchanged\"> </span> cache_from:\n<span class=\"token prefix unchanged\"> </span>   - ${CONTAINER_REGISTRY_BASE}/php\n<span class=\"token prefix unchanged\"> </span>   - ${CONTAINER_REGISTRY_BASE}/nginx\n<span class=\"token prefix unchanged\"> </span>   - ${CONTAINER_REGISTRY_BASE}/varnish\n</span>\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>x-network:\n<span class=\"token prefix inserted\">+</span>  &amp;network\n<span class=\"token prefix inserted\">+</span>  networks:\n<span class=\"token prefix inserted\">+</span>    - api_platform_network\n</span>\nservices:\n# Uncomment these lines only if you want to run one api-platform instance using traefik\n<span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span>  traefik:\n<span class=\"token prefix deleted\">-</span>    image: traefik:latest\n<span class=\"token prefix deleted\">-</span>    command: --api --docker\n<span class=\"token prefix deleted\">-</span>    ports:\n<span class=\"token prefix deleted\">-</span>      - \"80:80\"\n<span class=\"token prefix deleted\">-</span>      - \"443:443\"\n<span class=\"token prefix deleted\">-</span>    volumes:\n<span class=\"token prefix deleted\">-</span>      - /var/run/docker.sock:/var/run/docker.sock\n<span class=\"token prefix deleted\">-</span>    &lt;&lt;: *network\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> php:\n<span class=\"token prefix unchanged\"> </span>   image: ${CONTAINER_REGISTRY_BASE}/php\n<span class=\"token prefix unchanged\"> </span>   build:\n<span class=\"token prefix unchanged\"> </span>     context: ./api\n<span class=\"token prefix unchanged\"> </span>     target: api_platform_php\n<span class=\"token prefix unchanged\"> </span>     &lt;&lt;: *cache\n<span class=\"token prefix unchanged\"> </span>   depends_on: \n<span class=\"token prefix unchanged\"> </span>     - db\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    environment:\n<span class=\"token prefix inserted\">+</span>      # You should remove these variables from .env into api folder\n<span class=\"token prefix inserted\">+</span>      - TRUSTED_HOSTS=^(((${SUBDOMAINS_LIST}\\.)?${DOMAIN_NAME})|api)$$\n<span class=\"token prefix inserted\">+</span>      - CORS_ALLOW_ORIGIN=^${HTTP_OR_SSL}(${SUBDOMAINS_LIST}.)?${DOMAIN_NAME}$$\n<span class=\"token prefix inserted\">+</span>      - DATABASE_URL=postgres://${DB_USER}:${DB_PASS}@db/${DB_NAME}\n<span class=\"token prefix inserted\">+</span>      - MERCURE_SUBSCRIBE_URL=${HTTP_OR_SSL}mercure.${DOMAIN_NAME}$$\n<span class=\"token prefix inserted\">+</span>      - MERCURE_PUBLISH_URL=${HTTP_OR_SSL}mercure.${DOMAIN_NAME}$$\n<span class=\"token prefix inserted\">+</span>      - MERCURE_JWT_SECRET=${JWT_KEY}\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>   volumes:\n<span class=\"token prefix unchanged\"> </span>     - ./api:/srv/api:rw,cached\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    &lt;&lt;: *network\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> api:\n<span class=\"token prefix unchanged\"> </span>   image: ${CONTAINER_REGISTRY_BASE}/nginx\n<span class=\"token prefix unchanged\"> </span>   build:\n<span class=\"token prefix unchanged\"> </span>     context: ./api\n<span class=\"token prefix unchanged\"> </span>     target: api_platform_nginx\n<span class=\"token prefix unchanged\"> </span>     &lt;&lt;: *cache\n<span class=\"token prefix unchanged\"> </span>   depends_on:\n<span class=\"token prefix unchanged\"> </span>     - php\n<span class=\"token prefix unchanged\"> </span>   volumes:\n<span class=\"token prefix unchanged\"> </span>     - ./api/public:/srv/api/public:ro\n<span class=\"token prefix unchanged\"> </span>   labels:\n<span class=\"token prefix unchanged\"> </span>     - traefik.frontend.rule=Host:api.${DOMAIN_NAME}\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    &lt;&lt;: *network\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> cache-proxy:\n<span class=\"token prefix unchanged\"> </span>   image: ${CONTAINER_REGISTRY_BASE}/varnish\n<span class=\"token prefix unchanged\"> </span>   build:\n<span class=\"token prefix unchanged\"> </span>     context: ./api\n<span class=\"token prefix unchanged\"> </span>     target: api_platform_varnish\n<span class=\"token prefix unchanged\"> </span>     &lt;&lt;: *cache\n<span class=\"token prefix unchanged\"> </span>   depends_on:\n<span class=\"token prefix unchanged\"> </span>     - api\n<span class=\"token prefix unchanged\"> </span>   volumes:\n<span class=\"token prefix unchanged\"> </span>     - ./api/docker/varnish/conf:/usr/local/etc/varnish:ro\n<span class=\"token prefix unchanged\"> </span>   tmpfs:\n<span class=\"token prefix unchanged\"> </span>     - /usr/local/var/varnish:exec\n<span class=\"token prefix unchanged\"> </span>   labels:\n<span class=\"token prefix unchanged\"> </span>     - traefik.frontend.rule=Host:cache.${DOMAIN_NAME}\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    &lt;&lt;: *network\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> db:\n<span class=\"token prefix unchanged\"> </span>   image: postgres:10-alpine\n<span class=\"token prefix unchanged\"> </span>   environment:\n<span class=\"token prefix unchanged\"> </span>     - POSTGRES_DB=${DB_NAME}\n<span class=\"token prefix unchanged\"> </span>     - POSTGRES_USER=${DB_USER}\n<span class=\"token prefix unchanged\"> </span>     - POSTGRES_PASSWORD=${DB_PASS}\n<span class=\"token prefix unchanged\"> </span>   volumes:\n<span class=\"token prefix unchanged\"> </span>     - db-data:/var/lib/postgresql/data:rw\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    &lt;&lt;: *network\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> mercure:\n<span class=\"token prefix unchanged\"> </span>   image: dunglas/mercure\n<span class=\"token prefix unchanged\"> </span>   environment:\n<span class=\"token prefix unchanged\"> </span>     - JWT_KEY=${JWT_KEY}\n<span class=\"token prefix unchanged\"> </span>     - ALLOW_ANONYMOUS=0\n<span class=\"token prefix unchanged\"> </span>     - CORS_ALLOWED_ORIGINS=^${HTTP_OR_SSL}(${SUBDOMAINS_LIST}.)?${DOMAIN_NAME}$$\n<span class=\"token prefix unchanged\"> </span>     - PUBLISH_ALLOWED_ORIGINS=${HTTP_OR_SSL}\n<span class=\"token prefix unchanged\"> </span>     - DEMO=1\n<span class=\"token prefix unchanged\"> </span>   labels:\n<span class=\"token prefix unchanged\"> </span>     - traefik.frontend.rule=Host:mercure.${DOMAIN_NAME}\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    &lt;&lt;: *network\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> client:\n<span class=\"token prefix unchanged\"> </span>   image: ${CONTAINER_REGISTRY_BASE}/client\n<span class=\"token prefix unchanged\"> </span>   build:\n<span class=\"token prefix unchanged\"> </span>     context: ./client\n<span class=\"token prefix unchanged\"> </span>     cache_from:\n<span class=\"token prefix unchanged\"> </span>       - ${CONTAINER_REGISTRY_BASE}/client\n<span class=\"token prefix unchanged\"> </span>   volumes:\n<span class=\"token prefix unchanged\"> </span>     - ./client:/usr/src/client:rw,cached\n<span class=\"token prefix unchanged\"> </span>     - /usr/src/client/node_modules\n<span class=\"token prefix unchanged\"> </span>   expose:\n<span class=\"token prefix unchanged\"> </span>     - 3000\n<span class=\"token prefix unchanged\"> </span>   labels:\n<span class=\"token prefix unchanged\"> </span>     - traefik.frontend.rule=Host:${DOMAIN_NAME},www.${DOMAIN_NAME}\n<span class=\"token prefix unchanged\"> </span>     - traefik.port=3000\n<span class=\"token prefix unchanged\"> </span>   environment:\n<span class=\"token prefix unchanged\"> </span>     # You should remove this variable from .env into client folder\n<span class=\"token prefix unchanged\"> </span>     - REACT_APP_API_ENTRYPOINT=${HTTP_OR_SSL}api.${DOMAIN_NAME}\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    &lt;&lt;: *network\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> admin:\n<span class=\"token prefix unchanged\"> </span>   image: ${CONTAINER_REGISTRY_BASE}/admin\n<span class=\"token prefix unchanged\"> </span>   build:\n<span class=\"token prefix unchanged\"> </span>     context: ./admin\n<span class=\"token prefix unchanged\"> </span>     cache_from:\n<span class=\"token prefix unchanged\"> </span>       - ${CONTAINER_REGISTRY_BASE}/admin\n<span class=\"token prefix unchanged\"> </span>   environment:\n<span class=\"token prefix unchanged\"> </span>     # You should remove this variable from .env into admin folder\n<span class=\"token prefix unchanged\"> </span>     - REACT_APP_API_ENTRYPOINT=${HTTP_OR_SSL}api.${DOMAIN_NAME}\n<span class=\"token prefix unchanged\"> </span>   volumes:\n<span class=\"token prefix unchanged\"> </span>     - ./admin:/usr/src/admin:rw,cached\n<span class=\"token prefix unchanged\"> </span>     - /usr/src/admin/node_modules\n<span class=\"token prefix unchanged\"> </span>   expose:\n<span class=\"token prefix unchanged\"> </span>     - 3000\n<span class=\"token prefix unchanged\"> </span>   labels:\n<span class=\"token prefix unchanged\"> </span>     - traefik.frontend.rule=Host:admin.${DOMAIN_NAME}\n<span class=\"token prefix unchanged\"> </span>     - traefik.port=3000\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    &lt;&lt;: *network\n</span>\nvolumes:\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> db-data: {}\n</span>\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>networks:\n<span class=\"token prefix inserted\">+</span>  api_platform_network:\n<span class=\"token prefix inserted\">+</span>    external: true</span></code></pre></div>\n<p>Finally, some environment variables must be defined, here is an example of a <code class=\"language-text\">.env</code> file to set them: </p>\n<div class=\"gatsby-highlight\" data-language=\"dotenv\"><pre class=\"language-dotenv\"><code class=\"language-dotenv\">CONTAINER_REGISTRY_BASE=quay.io/api-platform\nDOMAIN_NAME=localhost\nHTTP_OR_SSL=http://\nDB_NAME=api-platform-db-name\nDB_PASS=YouMustChangeThisPassword\nDB_USER=api-platform\nJWT_KEY=!UnsecureChangeMe!\nSUBDOMAINS_LIST=(admin|api|cache|mercure|www)</code></pre></div>\n<p>This way, you can configure your main variables into one single file.</p>","nav":{"chapters":[{"title":"The Distribution: Create Powerful APIs with Ease","path":"distribution","items":[{"id":"index","title":"Getting Started with API Platform: Hypermedia and GraphQL API, Admin and Progressive Web App","anchors":[{"id":"installing-the-framework","title":"Installing the Framework","anchors":[{"id":"using-the-api-platform-distribution-recommended","title":"Using the API Platform Distribution (Recommended)"},{"id":"using-symfony-flex-and-composer-advanced-users","title":"Using Symfony Flex and Composer (advanced users)"}]},{"id":"its-ready","title":"It's Ready!"},{"id":"bringing-your-own-model","title":"Bringing your Own Model"},{"id":"validating-data","title":"Validating Data"},{"id":"adding-graphql-support","title":"Adding GraphQL Support"},{"id":"the-admin","title":"The Admin"},{"id":"a-reactredux-progressive-web-app","title":"A React/Redux Progressive Web App"},{"id":"other-features","title":"Other Features"}]},{"id":"testing","title":"Testing and Specifying the API","anchors":[{"id":"creating-data-fixtures","title":"Creating Data Fixtures"},{"id":"writing-functional-tests","title":"Writing Functional Tests","anchors":[{"id":"additional-and-alternative-testing-tools","title":"Additional and Alternative Testing Tools"}]},{"id":"writing-unit-tests","title":"Writing Unit Tests"}]},{"id":"debugging","title":"Debugging","anchors":[{"id":"add-a-development-stage-to-the-dockerfile","title":"Add a Development Stage to the Dockerfile"},{"id":"configure-xdebug-with-docker-compose-override","title":"Configure Xdebug with Docker Compose Override"},{"id":"troubleshooting","title":"Troubleshooting"}]}]},{"title":"The API Component","path":"core","items":[{"id":"index","title":"The API Platform Core Library","anchors":[{"id":"features","title":"Features"},{"id":"other-resources","title":"Other resources"}]},{"id":"getting-started","title":"Getting started","anchors":[{"id":"installing-api-platform-core","title":"Installing API Platform Core"},{"id":"before-reading-this-documentation","title":"Before Reading this Documentation"},{"id":"mapping-the-entities","title":"Mapping the Entities"}]},{"id":"design","title":"General Design Considerations"},{"id":"operations","title":"Operations","anchors":[{"id":"enabling-and-disabling-operations","title":"Enabling and Disabling Operations"},{"id":"configuring-operations","title":"Configuring Operations","anchors":[{"id":"prefixing-all-routes-of-all-operations","title":"Prefixing All Routes of All Operations"}]},{"id":"subresources","title":"Subresources","anchors":[{"id":"control-the-path-of-subresources","title":"Control the Path of Subresources"},{"id":"access-control-of-subresources","title":"Access Control of Subresources"},{"id":"control-the-depth-of-subresources","title":"Control the Depth of Subresources"}]},{"id":"creating-custom-operations-and-controllers","title":"Creating Custom Operations and Controllers","anchors":[{"id":"recommended-method","title":"Recommended Method","anchors":[{"id":"serialization-groups","title":"Serialization Groups"},{"id":"entity-retrieval","title":"Entity Retrieval"}]},{"id":"alternative-method","title":"Alternative Method"}]},{"id":"expose-a-model-without-any-routes","title":"Expose a model without any routes"}]},{"id":"graphql","title":"GraphQL Support","anchors":[{"id":"enabling-graphql","title":"Enabling GraphQL"},{"id":"graphiql","title":"GraphiQL"},{"id":"queries","title":"Queries","anchors":[{"id":"global-object-identifier","title":"Global Object Identifier"},{"id":"pagination","title":"Pagination"}]},{"id":"mutations","title":"Mutations","anchors":[{"id":"client-mutation-id","title":"Client Mutation Id"}]},{"id":"filters","title":"Filters","anchors":[{"id":"filtering-on-nested-properties","title":"Filtering on Nested Properties"}]},{"id":"security-access_control","title":"Security (access_control)"},{"id":"serialization-groups","title":"Serialization Groups"}]},{"id":"filters","title":"Filters","anchors":[{"id":"doctrine-orm-and-mongodb-odm-filters","title":"Doctrine ORM and MongoDB ODM Filters","anchors":[{"id":"basic-knowledge","title":"Basic Knowledge"},{"id":"search-filter","title":"Search Filter"},{"id":"date-filter","title":"Date Filter","anchors":[{"id":"managing-null-values","title":"Managing null Values"}]},{"id":"boolean-filter","title":"Boolean Filter"},{"id":"numeric-filter","title":"Numeric Filter"},{"id":"range-filter","title":"Range Filter"},{"id":"exists-filter","title":"Exists Filter"},{"id":"order-filter-sorting","title":"Order Filter (Sorting)","anchors":[{"id":"comparing-with-null-values","title":"Comparing with Null Values"},{"id":"using-a-custom-order-query-parameter-name","title":"Using a Custom Order Query Parameter Name"}]},{"id":"filtering-on-nested-properties","title":"Filtering on Nested Properties"},{"id":"enabling-a-filter-for-all-properties-of-a-resource","title":"Enabling a Filter for All Properties of a Resource"}]},{"id":"elasticsearch-filters","title":"Elasticsearch Filters","anchors":[{"id":"ordering-filter-sorting","title":"Ordering Filter (Sorting)","anchors":[{"id":"using-a-custom-order-query-parameter-name","title":"Using a Custom Order Query Parameter Name"}]},{"id":"match-filter","title":"Match Filter"},{"id":"term-filter","title":"Term Filter"},{"id":"filtering-on-nested-properties","title":"Filtering on Nested Properties"}]},{"id":"serializer-filters","title":"Serializer Filters","anchors":[{"id":"group-filter","title":"Group Filter"},{"id":"property-filter","title":"Property filter"}]},{"id":"creating-custom-filters","title":"Creating Custom Filters","anchors":[{"id":"creating-custom-doctrine-orm-filters","title":"Creating Custom Doctrine ORM Filters"},{"id":"creating-custom-doctrine-mongodb-odm-filters","title":"Creating Custom Doctrine MongoDB ODM Filters"},{"id":"creating-custom-elasticsearch-filters","title":"Creating Custom Elasticsearch Filters"},{"id":"using-doctrine-orm-filters","title":"Using Doctrine ORM Filters"}]},{"id":"apifilter-annotation","title":"ApiFilter Annotation"}]},{"id":"serialization","title":"The Serialization Process","anchors":[{"id":"overall-process","title":"Overall Process"},{"id":"available-serializers","title":"Available Serializers"},{"id":"the-serialization-context-groups-and-relations","title":"The Serialization Context, Groups and Relations","anchors":[{"id":"configuration","title":"Configuration"}]},{"id":"using-serialization-groups","title":"Using Serialization Groups"},{"id":"using-serialization-groups-per-operation","title":"Using Serialization Groups per Operation","anchors":[{"id":"embedding-relations","title":"Embedding Relations"},{"id":"denormalization","title":"Denormalization"}]},{"id":"changing-the-serialization-context-dynamically","title":"Changing the Serialization Context Dynamically"},{"id":"changing-the-serialization-context-on-a-per-item-basis","title":"Changing the Serialization Context on a Per-item Basis"},{"id":"name-conversion","title":"Name Conversion"},{"id":"decorating-a-serializer-and-adding-extra-data","title":"Decorating a Serializer and Adding Extra Data"},{"id":"entity-identifier-case","title":"Entity Identifier Case"},{"id":"embedding-the-json-ld-context","title":"Embedding the JSON-LD Context"},{"id":"collection-relation","title":"Collection Relation"}]},{"id":"validation","title":"Validation","anchors":[{"id":"validating-submitted-data","title":"Validating Submitted Data"},{"id":"using-validation-groups","title":"Using Validation Groups"},{"id":"using-validation-groups-on-operations","title":"Using Validation Groups on Operations"},{"id":"dynamic-validation-groups","title":"Dynamic Validation Groups"},{"id":"error-levels-and-payload-serialization","title":"Error Levels and Payload Serialization"},{"id":"validation-on-collection-relations","title":"Validation on Collection Relations"},{"id":"open-vocabulary-generated-from-validation-metadata","title":"Open Vocabulary Generated from Validation Metadata"}]},{"id":"security","title":"Security","anchors":[{"id":"configuring-the-access-control-message","title":"Configuring the Access Control Message"}]},{"id":"data-providers","title":"Data Providers","anchors":[{"id":"custom-collection-data-provider","title":"Custom Collection Data Provider"},{"id":"custom-item-data-provider","title":"Custom Item Data Provider"},{"id":"injecting-the-serializer-in-an-itemdataprovider","title":"Injecting the Serializer in an ItemDataProvider"},{"id":"injecting-extensions-pagination-filter-eagerloading-etc","title":"Injecting Extensions (Pagination, Filter, EagerLoading etc.)"}]},{"id":"data-persisters","title":"Data Persisters","anchors":[{"id":"creating-a-custom-data-persister","title":"Creating a Custom Data Persister"}]},{"id":"mercure","title":"Pushing Live Updates Using the Mercure Protocol","anchors":[{"id":"installing-mercure-support","title":"Installing Mercure Support"},{"id":"pushing-the-api-updates","title":"Pushing the API Updates"},{"id":"dispatching-private-updates-authorized-mode","title":"Dispatching Private Updates (Authorized Mode)"}]},{"id":"mongodb","title":"MongoDB Support","anchors":[{"id":"overview","title":"Overview"},{"id":"enabling-mongodb-support","title":"Enabling MongoDB Support"},{"id":"creating-documents","title":"Creating Documents"},{"id":"filtering","title":"Filtering"},{"id":"creating-custom-extensions","title":"Creating Custom Extensions"}]},{"id":"elasticsearch","title":"Elasticsearch Support","anchors":[{"id":"overview","title":"Overview"},{"id":"enabling-reading-support","title":"Enabling Reading Support"},{"id":"creating-models","title":"Creating Models","anchors":[{"id":"creating-custom-mapping","title":"Creating custom mapping"}]},{"id":"filtering","title":"Filtering"},{"id":"creating-custom-extensions","title":"Creating Custom Extensions"}]},{"id":"pagination","title":"Pagination","anchors":[{"id":"disabling-the-pagination","title":"Disabling the Pagination","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"},{"id":"client-side","title":"Client-side","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a specific resource"}]}]},{"id":"changing-the-number-of-items-per-page","title":"Changing the Number of Items per Page","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"},{"id":"client-side","title":"Client-side","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"}]}]},{"id":"changing-maximum-items-per-page","title":"Changing Maximum items per page","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"},{"id":"for-a-specific-resource-collection-operation","title":"For a Specific Resource Collection Operation"}]},{"id":"partial-pagination","title":"Partial Pagination","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"},{"id":"client-side","title":"Client-side","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"}]}]},{"id":"controlling-the-behavior-of-the-doctrine-orm-paginator","title":"Controlling the behavior of the Doctrine ORM Paginator"},{"id":"custom-controller-action","title":"Custom Controller Action"}]},{"id":"events","title":"The Event System","anchors":[{"id":"built-in-event-listeners","title":"Built-in Event Listeners"},{"id":"custom-event-listeners","title":"Custom Event Listeners"}]},{"id":"content-negotiation","title":"Content Negotiation","anchors":[{"id":"enabling-several-formats","title":"Enabling Several Formats"},{"id":"enabling-additional-formats-on-a-specific-resourceoperation","title":"Enabling Additional Formats On a Specific Resource/Operation"},{"id":"registering-a-custom-serializer","title":"Registering a Custom Serializer"},{"id":"writing-a-custom-normalizer","title":"Writing a Custom Normalizer"}]},{"id":"deprecations","title":"Deprecating Resources and Properties (Alternative to Versioning)","anchors":[{"id":"deprecating-resource-classes-operations-and-properties","title":"Deprecating Resource Classes, Operations and Properties"},{"id":"setting-the-sunset-http-header-to-indicate-when-a-resource-or-an-operation-will-be-removed","title":"Setting the Sunset HTTP Header to Indicate When a Resource or an Operation Will Be Removed"}]},{"id":"performance","title":"Performance and Cache","anchors":[{"id":"enabling-the-built-in-http-cache-invalidation-system","title":"Enabling the Built-in HTTP Cache Invalidation System","anchors":[{"id":"extending-cache-tags-for-invalidation","title":"Extending Cache-Tags for Invalidation"}]},{"id":"setting-custom-http-cache-headers","title":"Setting Custom HTTP Cache Headers"},{"id":"enabling-the-metadata-cache","title":"Enabling the Metadata Cache"},{"id":"using-ppm-php-pm","title":"Using PPM (PHP-PM)"},{"id":"doctrine-queries-and-indexes","title":"Doctrine Queries and Indexes","anchors":[{"id":"search-filter","title":"Search Filter"},{"id":"eager-loading","title":"Eager Loading","anchors":[{"id":"max-joins","title":"Max Joins"},{"id":"force-eager","title":"Force Eager"},{"id":"override-at-resource-and-operation-level","title":"Override at Resource and Operation Level"},{"id":"disable-eager-loading","title":"Disable Eager Loading"}]},{"id":"partial-pagination","title":"Partial Pagination"}]},{"id":"profiling-with-blackfireio","title":"Profiling with Blackfire.io"}]},{"id":"extensions","title":"Extensions","anchors":[{"id":"custom-doctrine-orm-extension","title":"Custom Doctrine ORM Extension","anchors":[{"id":"example","title":"Example","anchors":[{"id":"blocking-anonymous-users","title":"Blocking Anonymous Users"}]}]},{"id":"custom-doctrine-mongodb-odm-extension","title":"Custom Doctrine MongoDB ODM Extension"},{"id":"custom-elasticsearch-extension","title":"Custom Elasticsearch Extension"}]},{"id":"swagger","title":"OpenAPI Specification Support (formerly Swagger)","anchors":[{"id":"using-the-openapi-command","title":"Using the OpenAPI Command"},{"id":"overriding-the-openapi-specification","title":"Overriding the OpenAPI Specification"},{"id":"using-the-openapi-and-swagger-contexts","title":"Using the OpenAPI and Swagger Contexts"},{"id":"changing-the-name-of-a-definition","title":"Changing the Name of a Definition"},{"id":"changing-operations-in-the-openapi-documentation","title":"Changing Operations in the OpenAPI Documentation"},{"id":"changing-the-location-of-swagger-ui","title":"Changing the Location of Swagger UI","anchors":[{"id":"disabling-swagger-ui-or-redoc","title":"Disabling Swagger UI or ReDoc"},{"id":"manually-registering-the-swagger-ui-controller","title":"Manually Registering the Swagger UI Controller"}]},{"id":"overriding-the-ui-template","title":"Overriding the UI Template"},{"id":"compatibilily-layer-with-amazon-api-gateway","title":"Compatibilily Layer with Amazon API Gateway"}]},{"id":"messenger","title":"Symfony Messenger Integration: CQRS and Async Message Processing","anchors":[{"id":"installing-symfony-messenger","title":"Installing Symfony Messenger"},{"id":"dispatching-a-resource-through-the-message-bus","title":"Dispatching a Resource through the Message Bus"},{"id":"registering-a-message-handler","title":"Registering a Message Handler"},{"id":"accessing-the-data-returned-by-the-handler","title":"Accessing the Data Returned by the Handler"},{"id":"detecting-removals","title":"Detecting Removals"},{"id":"using-messenger-with-an-input-object","title":"Using Messenger with an Input Object"}]},{"id":"dto","title":"Using Data Transfer Objects (DTOs)","anchors":[{"id":"specifying-an-input-or-an-output-data-representation","title":"Specifying an Input or an Output Data Representation"},{"id":"updating-a-resource-with-a-custom-input","title":"Updating a Resource with a Custom Input"},{"id":"disabling-the-input-or-the-output","title":"Disabling the Input or the Output"},{"id":"per-operation-input-and-output","title":"Per Operation input and output"},{"id":"inputoutput-metadata","title":"Input/Output Metadata"},{"id":"using-objects-as-relations-inside-resources","title":"Using Objects As Relations Inside Resources"},{"id":"validating-data-transfer-objects","title":"Validating Data Transfer Objects"}]},{"id":"push-relations","title":"Pushing Related Resources Using HTTP/2"},{"id":"file-upload","title":"Handling File Upload","anchors":[{"id":"installing-vichuploaderbundle","title":"Installing VichUploaderBundle"},{"id":"configuring-the-entity-receiving-the-uploaded-file","title":"Configuring the Entity Receiving the Uploaded File"},{"id":"handling-file-upload","title":"Handling File Upload"},{"id":"resolving-the-file-url","title":"Resolving the File URL"},{"id":"making-a-request-to-the-media_objects-endpoint","title":"Making a Request to the /media_objects Endpoint"},{"id":"linking-a-mediaobject-resource-to-another-resource","title":"Linking a MediaObject Resource to Another Resource"}]},{"id":"default-order","title":"Overriding Default Order"},{"id":"errors","title":"Errors Handling","anchors":[{"id":"converting-php-exceptions-to-http-errors","title":"Converting PHP Exceptions to HTTP Errors"}]},{"id":"external-vocabularies","title":"Using External Vocabularies"},{"id":"operation-path-naming","title":"Operation Path Naming","anchors":[{"id":"configuration","title":"Configuration"},{"id":"create-a-custom-operation-path-resolver","title":"Create a Custom Operation Path Resolver","anchors":[{"id":"defining-the-operation-path-resolver","title":"Defining the Operation Path Resolver"},{"id":"registering-the-service","title":"Registering the Service"},{"id":"configuring-it","title":"Configuring It"}]}]},{"id":"extending-jsonld-context","title":"Extending JSON-LD Context"},{"id":"form-data","title":"Accept application/x-www-form-urlencoded Form Data","anchors":[{"id":"create-your-deserializelistener-decorator","title":"Create your DeserializeListener Decorator"},{"id":"creating-the-service-definition","title":"Creating the Service Definition"}]},{"id":"identifiers","title":"Identifiers","anchors":[{"id":"custom-identifier-normalizer","title":"Custom Identifier Normalizer"},{"id":"supported-identifiers","title":"Supported Identifiers"}]},{"id":"jwt","title":"JWT Authentication","anchors":[{"id":"installing-lexikjwtauthenticationbundle","title":"Installing LexikJWTAuthenticationBundle"},{"id":"configuring-the-symfony-securitybundle","title":"Configuring the Symfony SecurityBundle","anchors":[{"id":"adding-authentication-to-an-api-which-uses-a-path-prefix","title":"Adding Authentication to an API Which Uses a Path Prefix"}]},{"id":"documenting-the-authentication-mechanism-with-swaggeropen-api","title":"Documenting the Authentication Mechanism with Swagger/Open API","anchors":[{"id":"configuring-api-platform","title":"Configuring API Platform"},{"id":"adding-a-new-api-key","title":"Adding a New API Key"}]},{"id":"testing-with-behat","title":"Testing with Behat"}]},{"id":"angularjs-integration","title":"AngularJS Integration","anchors":[{"id":"restangular","title":"Restangular"},{"id":"ng-admin","title":"ng-admin"}]},{"id":"fosuser-bundle","title":"FOSUserBundle Integration","anchors":[{"id":"installing-the-bundle","title":"Installing the Bundle"},{"id":"enabling-the-bridge","title":"Enabling the Bridge"},{"id":"creating-a-user-entity-with-serialization-groups","title":"Creating a User Entity with Serialization Groups"}]},{"id":"nelmio-api-doc","title":"NelmioApiDocBundle Integration"},{"id":"configuration","title":"Configuration"}]},{"title":"The Schema Generator Component","path":"schema-generator","items":[{"id":"index","title":"The Schema Generator","anchors":[{"id":"what-is-schemaorg","title":"What Is Schema.org?"},{"id":"why-use-schemaorg-data-to-generate-a-php-model","title":"Why Use Schema.org Data to Generate a PHP Model?","anchors":[{"id":"dont-reinvent-the-wheel","title":"Don't Reinvent the Wheel"},{"id":"improve-seo-and-user-experience","title":"Improve SEO and User Experience"},{"id":"be-ready-for-the-future","title":"Be Ready for The Future"}]},{"id":"documentation","title":"Documentation"}]},{"id":"getting-started","title":"Getting Started","anchors":[{"id":"installation","title":"Installation"},{"id":"model-scaffolding","title":"Model Scaffolding","anchors":[{"id":"going-further","title":"Going Further"}]},{"id":"cardinality-extraction","title":"Cardinality Extraction"}]},{"id":"configuration","title":"Configuration","anchors":[{"id":"customizing-php-namespaces","title":"Customizing PHP Namespaces"},{"id":"forcing-a-field-range","title":"Forcing a Field Range"},{"id":"forcing-a-field-cardinality","title":"Forcing a Field Cardinality"},{"id":"forcing-a-relation-table-name","title":"Forcing a Relation Table Name"},{"id":"forcing-or-disabling-a-class-parent","title":"Forcing (or Disabling) a Class Parent"},{"id":"forcing-a-class-to-be-abstract","title":"Forcing a Class to be Abstract"},{"id":"forcing-a-nullable-property","title":"Forcing a Nullable Property"},{"id":"forcing-a-unique-property","title":"Forcing a Unique Property"},{"id":"making-a-property-read-only","title":"Making a Property Read-Only"},{"id":"making-a-property-write-only","title":"Making a Property Write-Only"},{"id":"forcing-a-property-to-be-in-a-serialization-group","title":"Forcing a Property to be in a Serialization Group"},{"id":"forcing-an-embeddable-class-to-be-embedded","title":"Forcing an Embeddable Class to be Embedded"},{"id":"author-phpdoc","title":"Author PHPDoc"},{"id":"disabling-generators-and-creating-custom-ones","title":"Disabling Generators and Creating Custom Ones"},{"id":"skipping-accessor-method-generation","title":"Skipping Accessor Method Generation"},{"id":"disabling-the-id-generator","title":"Disabling the id Generator"},{"id":"generating-uuids","title":"Generating UUIDs"},{"id":"user-submitted-uuids","title":"User submitted UUIDs"},{"id":"generating-custom-ids","title":"Generating Custom IDs"},{"id":"disabling-usage-of-doctrine-collections","title":"Disabling Usage of Doctrine Collections"},{"id":"changing-the-field-visibility","title":"Changing the Field Visibility"},{"id":"generating-asserttype-annotations","title":"Generating @Assert\\Type Annotations"},{"id":"forcing-doctrine-inheritance-mapping-annotation","title":"Forcing Doctrine Inheritance Mapping Annotation"},{"id":"interfaces-and-doctrine-resolve-target-entity-listener","title":"Interfaces and Doctrine Resolve Target Entity Listener"},{"id":"custom-schemas","title":"Custom Schemas"},{"id":"checking-goodrelation-compatibility","title":"Checking GoodRelation Compatibility"},{"id":"php-file-header","title":"PHP File Header"},{"id":"full-configuration-reference","title":"Full Configuration Reference"}]}]},{"title":"The Admin Component","path":"admin","items":[{"id":"index","title":"The API Platform Admin","anchors":[{"id":"features","title":"Features"}]},{"id":"getting-started","title":"Getting Started","anchors":[{"id":"installation","title":"Installation"},{"id":"creating-the-admin","title":"Creating the Admin"},{"id":"customizing-the-admin","title":"Customizing the Admin","anchors":[{"id":"using-custom-components","title":"Using Custom Components"},{"id":"managing-files-and-images","title":"Managing Files and Images"},{"id":"using-a-custom-validation-function-or-inject-custom-props","title":"Using a Custom Validation Function or Inject Custom Props"},{"id":"show-the-names-of-your-entities-instead-of-their-iris","title":"Show the Names of your Entities Instead of their IRIs"},{"id":"using-the-hydra-data-provider-directly-with-react-admin","title":"Using the Hydra Data Provider Directly with react-admin"}]}]},{"id":"authentication-support","title":"Authentication Support"},{"id":"handling-relations-to-collections","title":"Handling Relations to Collections","anchors":[{"id":"customizing-a-property","title":"Customizing a Property"},{"id":"customizing-an-icon","title":"Customizing an Icon"},{"id":"using-an-autocomplete-input-for-relations","title":"Using an Autocomplete Input for Relations"}]},{"id":"customizing","title":"Customizing the Admin","anchors":[{"id":"preparing-your-app","title":"Preparing your App"},{"id":"customizing-inputs","title":"Customizing Inputs"},{"id":"customizing-fields","title":"Customizing Fields"},{"id":"free-mode","title":"\"Free\" Mode"},{"id":"reusing-the-default-layout","title":"Reusing the Default Layout","anchors":[{"id":"list","title":"List"},{"id":"create","title":"Create","anchors":[{"id":"customizing-the-form-layout","title":"Customizing the Form Layout"},{"id":"dynamic-display","title":"Dynamic Display"}]},{"id":"edit","title":"Edit"}]}]}]},{"title":"The Client Generator Component","path":"client-generator","items":[{"id":"index","title":"The API Platform Client Generator","anchors":[{"id":"features","title":"Features"}]},{"id":"react","title":"React Generator","anchors":[{"id":"install","title":"Install"},{"id":"generating-a-progressive-web-app","title":"Generating a Progressive Web App"},{"id":"screenshots","title":"Screenshots"}]},{"id":"nextjs","title":"Next.js Generator","anchors":[{"id":"install","title":"Install","anchors":[{"id":"next--express-server","title":"Next + Express Server"},{"id":"enabling-typescript","title":"Enabling Typescript"},{"id":"installing-the-generator-dependencies","title":"Installing the Generator Dependencies"}]},{"id":"starting-the-project","title":"Starting the Project"},{"id":"generating-routes","title":"Generating Routes"},{"id":"screenshots","title":"Screenshots"}]},{"id":"react-native","title":"React Native generator","anchors":[{"id":"install","title":"Install"},{"id":"generating-a-native-app","title":"Generating a Native App"},{"id":"screenshots-in-ios-simulator","title":"Screenshots in iOS Simulator"}]},{"id":"vuejs","title":"Vue.js Generator"},{"id":"quasar","title":"Quasar Framework Generator"},{"id":"typescript","title":"Typescript Interfaces","anchors":[{"id":"example","title":"Example"}]},{"id":"troubleshooting","title":"Troubleshooting"}]},{"title":"Deployment","path":"deployment","items":[{"id":"index","title":"Deploying API Platform Applications"},{"id":"kubernetes","title":"Deploying to a Kubernetes Cluster","anchors":[{"id":"preparing-your-cluster-and-your-local-machine","title":"Preparing Your Cluster and Your Local Machine"},{"id":"creating-and-publishing-the-docker-images","title":"Creating and Publishing the Docker Images"},{"id":"deploying","title":"Deploying"},{"id":"initializing-the-database","title":"Initializing the Database"},{"id":"tiller-rbac-issue","title":"Tiller RBAC Issue"}]},{"id":"heroku","title":"Deploying an API Platform App on Heroku"},{"id":"traefik","title":"Implement Traefik Into API Platform Dockerized","anchors":[{"id":"basic-implementation","title":"Basic Implementation"},{"id":"known-issues","title":"Known Issues"},{"id":"going-further","title":"Going Further"}]}]},{"title":"Extra","path":"extra","items":[{"id":"releases","title":"The Release Process"},{"id":"philosophy","title":"API Platform's Philosophy"},{"id":"troubleshooting","title":"Troubleshooting","anchors":[{"id":"using-docker","title":"Using Docker","anchors":[{"id":"with-docker-toolbox-on-windows","title":"With Docker Toolbox on Windows"},{"id":"error-starting-userland-proxy","title":"Error starting userland proxy"}]},{"id":"using-api-platform-and-jms-serializer-in-the-same-project","title":"Using API Platform and JMS Serializer in the same project"},{"id":"upstream-sent-too-big-header-while-reading-response-header-from-upstream-502-error","title":"\"upstream sent too big header while reading response header from upstream\" 502 Error"}]},{"id":"contribution-guides","title":"Contribution guides"},{"id":"conduct","title":"Contributor Code of Conduct","anchors":[{"id":"our-pledge","title":"Our Pledge"},{"id":"our-standards","title":"Our Standards"},{"id":"our-responsibilities","title":"Our Responsibilities"},{"id":"scope","title":"Scope"},{"id":"enforcement","title":"Enforcement"},{"id":"attribution","title":"Attribution"}]}]}]},"next":{},"prefixedVersion":"v2.4","previous":{"slug":"/docs/v2.4/deployment/heroku/","title":"Deploying an API Platform App on Heroku"},"title":"Implement Traefik Into API Platform Dockerized","urlEditDocumentation":"https://github.com/api-platform/docs/edit/2.4/deployment/traefik.md","version":"v2.4/"}},"staticQueryHashes":["1552981879"]}